<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta
      name="viewport"
      content="width=device-width,width=device-height,initial-scale=1,maximum-scale=1"
    />
  </head>
  <body
    style="
      height: 100vh;
      width: 100vw;
      display: flex;
      margin: 0 !important;
      padding: 0 !important;
    "
  >
    <div id="container">
      <div id="mount-node" class="mount-node" contenteditable="true"/>
    </div>

    <script>

      window.selectContents = function selectContents(el) {
        var sel = window.getSelection();
        var range = document.createRange();
        range.selectNodeContents(el);
        sel.removeAllRanges();
        sel.addRange(range);
      }
    </script>

    <style>
      #container {
        overflow: hidden;
        flex: 1;
      }

      #mount-node {
        height: 100%;
      }

    </style>

    <script src="./monaco-editor/dev/vs/loader.js"></script>
    <script>
      require.config({ paths: { vs: "./monaco-editor/dev/vs" } });
      require(["vs/editor/editor.main"], function () {
        let editor = monaco.editor.create(
          document.getElementById("mount-node"),
          {
            value: `function x() {
  console.log("Hello world!");
}`,
            language: "javascript",
            theme: "vs-dark",
            automaticLayout: true,
            fontSize: "16px",
            minimap: { enabled: false },
            scrollBeyondLastLine: false,
            codeLens: false,
            contextmenu: false,
            wordWrap: "on",
            lineNumbersMinChars: 2,
            folding: false,
            selectionHighlight: false
          }
        );
        window.editor = editor;
        window.monaco = monaco;

        window.extractCode = function () {
          window.ReactNativeWebView.postMessage(
            JSON.stringify({
              type: "extract",
              value: window.editor.getValue(),
            })
          );
        };
      });
    </script>
  </body>
</html>
